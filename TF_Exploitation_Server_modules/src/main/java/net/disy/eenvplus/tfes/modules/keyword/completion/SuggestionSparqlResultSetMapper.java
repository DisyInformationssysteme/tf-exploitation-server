//Copyright (c) 2014 by Disy Informationssysteme GmbH
package net.disy.eenvplus.tfes.modules.keyword.completion;

import static net.disy.eenvplus.tfes.modules.sparql.query.SparqlNodes.CONCEPT;
import static net.disy.eenvplus.tfes.modules.sparql.query.SparqlNodes.LABEL;
import static net.disy.eenvplus.tfes.modules.sparql.result.ResultFactory.createSuggestion;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import net.disy.eenvplus.tfes.core.api.response.ISuggestion;

import com.hp.hpl.jena.query.QuerySolution;
import com.hp.hpl.jena.query.ResultSet;

// NOT_PUBLISHED
public class SuggestionSparqlResultSetMapper {

  private String sourceLabel;

  private SuggestionSparqlResultSetMapper(String sourceLabel) {
    this.sourceLabel = sourceLabel;
  }

  public static SuggestionSparqlResultSetMapper create(String sourceLabel) {
    return new SuggestionSparqlResultSetMapper(sourceLabel);
  }

  public Collection<ISuggestion> map(ResultSet resultSet) {
    List<ISuggestion> result = new ArrayList<>();

    while (resultSet.hasNext()) {
      final QuerySolution current = resultSet.next();
      ISuggestion suggestion = createSuggestion(current, LABEL, CONCEPT, sourceLabel);
      result.add(suggestion);
    }
    return result;

  }

}
