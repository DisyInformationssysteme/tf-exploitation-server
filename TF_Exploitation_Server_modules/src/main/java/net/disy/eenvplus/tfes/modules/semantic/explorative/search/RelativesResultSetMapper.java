//Copyright (c) 2014 by Disy Informationssysteme GmbH
package net.disy.eenvplus.tfes.modules.semantic.explorative.search;

import static net.disy.eenvplus.tfes.modules.sparql.query.SparqlNodes.CONCEPT;
import static net.disy.eenvplus.tfes.modules.sparql.query.SparqlNodes.LABEL;
import static net.disy.eenvplus.tfes.modules.sparql.query.SparqlNodes.RELATION;
import static net.disy.eenvplus.tfes.modules.sparql.result.ResultFactory.createRelative;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import net.disy.eenvplus.tfes.core.api.response.IRelative;

import com.hp.hpl.jena.query.QuerySolution;
import com.hp.hpl.jena.query.ResultSet;

// NOT_PUBLISHED
public class RelativesResultSetMapper {

  private String sourceLabel;

  private RelativesResultSetMapper(String sourceLabel) {
    this.sourceLabel = sourceLabel;
  }

  public static RelativesResultSetMapper create(String sourceLabel) {
    return new RelativesResultSetMapper(sourceLabel);
  }

  public Collection<IRelative> map(ResultSet resultSet) {
    List<IRelative> result = new ArrayList<>();

    while (resultSet.hasNext()) {
      final QuerySolution current = resultSet.next();
      IRelative relative = createRelative(current, LABEL, CONCEPT, RELATION, sourceLabel);
      result.add(relative);
    }
    return result;
  }

}
